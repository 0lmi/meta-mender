#@TYPE: Machine
#@NAME: vexpress-qemu

#@DESCRIPTION: Machine configuration for QEMU running vexpress with system on MTD device

require conf/machine/include/qemu.inc
require conf/machine/include/vexpress.inc

IMAGE_FSTYPES_append = " ubifs ubi"

MACHINE_ESSENTIAL_EXTRA_RDEPENDS = "kernel-image kernel-devicetree"
MACHINE_ESSENTIAL_EXTRA_RRECOMMENDS += "mtd-utils mtd-utils-ubifs mtd-utils-jffs2"

MKUBIFS_ARGS = "-m 1 -e 262016 -c 1024"
UBINIZE_ARGS = "-p 256KiB -m 1 -O 64"

# NOTE: normally we'd pick up overrides for vexpress-qemu, disable them for now
# to avoid incorrect u-boot patches being applied (on a side note, maybe rework
# u-boot patches to be applied for any machine?)

#MACHINEOVERRIDES =. "vexpress-qemu-flash:vexpress-qemu:"

# Needed to skip particular QA checks that don't apply to U-boot's binary.
INSANE_SKIP_u-boot += "ldflags textrel"
